{"google":"UA-36856653-1","tagline":"Interpolation and Statistical Proximity of 3C Tables","body":"# INSP3CT\r\n\r\n***\r\n\r\n## Interpolation and Statistical Proximity of 3C Tables\r\n### Version 1.0\r\n\r\n***\r\n\r\nProvided as supplementary alongside - \r\n> \"Spatial localization of co-regulated genes exceeds genomic gene clustering in the S. cerevisiae genome\"\r\n> By Shay Ben-Elazar, Zohar Yakhini, and Itai Yanai. Accepted for publication to NAR (Dec 2012).\r\n\r\n***\r\n\r\n## Description\r\nThis program can be used to take a sparse contact dataset and interpolate it to a sampled matrix at an arbitrary resolution. On top of the resulting matrix, any set of annotation of loci is then inspected for co-localization both in 3d and 1d.\r\nThe result can then optionally be displayed in a figure similar to Figure 3 in the above paper.\r\n\r\n## Requirements\r\nIt is recommended to run this on a machine with at least 8 GB of RAM, depending on the size of the dataset.\r\nMultiple cores can and should be utilized to speed up analysis.\r\nOur setup (for this particular dataset) was a machine with 192 GB RAM and 12 dedicated cores.\r\nBasic Matlab knowhow is a prerequisite.\r\n\r\n## Input and parameters:\r\nEdit the main pipeline file, INSP3CT.m, and make sure to set the following parameters.\r\n### Required input files:\r\n* PARAMETERS.interfrequencies - filename of the inter-chromosomal frequencies tab-delimited in the format with the following header:   \r\nchr1\tlocus1\tchr2\tlocus2\tfrequency\r\n* PARAMETERS.intrafrequencies - filename of the intra-chromosomal frequencies tab-delimited in the same format, where chr1=chr2.\r\n* PARAMETERS.ChromosomeSizes - An array holding the number of bases in each chromosome in the genome.\r\n\t\r\nAn example of a sufficient file-set can be found on github ([YeastDatasetExample.zip](https://github.com/shayben/INSP3CT/blob/master/YeastDatasetExample.zip)). The parameters corresponding  to this input are commented out in the code.\r\n\r\n### Additional parameters:\r\n* PARAMETERS.cores - number of cores in the machine used for processing. More cores is faster but requires more RAM as well.\r\n* PARAMETERS.binningresolution - the number of nucleotides which are considered as a locus. Smaller value -> larger dataset and slower to compute but provides more accuracy in the results.\r\n* PARAMETERS.analysis_shuffle - set to true for a random control.\r\n* PARAMETERS.analysis_cyclic - set to true for a cyclic permutation control.\r\n\r\n### You also need to manually create the following variables before running any co-localization analysis:\r\n* Loci - A vector of k bin indices containing points of interest.\r\n* AnnotationData - A matrix of size kXn where each row is a point of interest and each column an annotation. The (i,j)-th entry is the number of elements annotated as j which reside in bin Loci[i].\r\n\r\nThere is a commented-out example which randomly generates loci and annotations used for testing.\r\n\r\n## Usage\r\nMain file is INSP3CT.m.\r\n* The first code block, labeled \"INSP3CT pipeline\", loads the parameters and asserts their validity.\r\n* The second code block, labeled \"Load and parse datasets\", Prepares the data structures used to generate the interpolated contact frequency matrix.\r\n* The third code block, labeled \"Generate interpolated and binned frequencies\", runs the interpolation step.\r\n### The next two blocks can be used if Loci and AnnotationData are set:\r\n* The forth code block, labeled \"Analysis on annotation\" given an annotation on the binned genome, analyzes 3D vs 1D co-localizations using mHG (1,2).\r\n* The fifth code block, labeled \"Show a result figure for each annotation\", plots each annotation showing the resulting landscape of enrichment. Pressing any keyboard key will continue to show the next annotation.\r\n\r\n> 1. Eden, E., Lipson, D., Yogev, S. and Yakhini, Z. (2007) Discovering motifs in ranked lists of DNA sequences. PLoS Comput Biol, 3, e39 \r\n> 2. Eden, E., Navon, R., Steinfeld, I., Lipson, D. and Yakhini, Z. (2009) GOrilla: a tool for discovery and visualization of enriched GO terms in ranked gene lists. BMC Bioinformatics, 10, 48.).\r\n\r\n\r\n## Output\r\n* obj.Interpolated - cell array containing interpolated chromosomal contact frequencies binned to the requested resolution.\r\n### If Loci and AnnotationData are set \r\n* The resulting enrichment comparisons are a set of figures for the respective annotations.\r\n* corrected3d - Corrected mHG (partition limited) score for 3D enrichment around loci for each annotation.\r\n* corrected1d - Corrected mHG (partition limited) score for 1D enrichment around loci for each annotation.\r\n* allbestspheresizes - mHG threshold on 3D ordered loci.\r\n* allbestintsizes - mHG threshold on 1D ordered loci.\r\n\r\n## Disclaimer\r\nThese scripts are provided as is and under the GPL license.\r\nMuch of the code is *NOT* optimized since it has undergone many iterations and was not specially tailored for the purposes in this code. Please make sure to read the instructions and paper thoroughly before contacting the authors.\r\nImportantly, please note that the analysis in the paper was performed on a haploid genome and there are repercussions for switching to a diploid genome in the interpretation of the input data which were not addressed in this code or paper.\r\n\r\n## Copyright\r\n> This program is free software: you can redistribute it and/or modify\r\n> it under the terms of the GNU General Public License as published by\r\n> the Free Software Foundation, either version 3 of the License, or\r\n> (at your option) any later version.\r\n\r\n> This program is distributed in the hope that it will be useful,\r\n> but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n> MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n> GNU General Public License for more details.\r\n\r\n> You should have received a copy of the GNU General Public License\r\n> along with this program.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n## Contact\r\nFor questions regarding this program e-mail: shayben@cs.technion.ac.il.\r\nFurther inqueries can be directed to Itai Yanai, [website](http://yanailab.technion.ac.il/) email: yanai@technion.ac.il.\r\n\r\n***\r\n\r\nCopyright 2012 Shay Ben Elazar Â©","name":"INSP3CT","note":"Don't delete this file! It's used internally to help with page regeneration."}